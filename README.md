This repository contains the Matlab code that analyzed the raw data on the performance of 8 pigeons on three different VI schedules, then on three different VI schedules with a hang fire delay (a non-negligible interval between the peck that triggered reinforcement and the delivery of the reinforcement), and finally on VI schedules in which varying percentages of the reinforcements were delivered gratis. The code has three components: 1)  The script; CraigShahan.m. 2) The TSlib toolbox; all the files with names TS*.m 3) Custom helper functions for this script; all the .m files that do not begin with TS except the script file itself (CraigShahan.m) The script uses the toolbox functions. These functions all read data from fields in a Matlab structure variable named 'Experiment', operate on those data (often with the help of a helper function), and write the results back into a field in the Experiment structure. The original script began by creating the Experiment structure and reading the raw data from the MedPC files into the TSData fields at the Session level in that structure. The script in this repository, however, assumes that the Experiment structure with the raw data loaded into it already exists in the file named CraigShahanWonlyData.mat, which is included in this repository. Calling the script from the Matlab command line creates the finished structure and a folder full of figures, 5 of which are the ones that appear in the paper by Gallistel, Craig and Shahan in the Psychological Review (2019). This will work only if TSlib and the HelperFunctions folders are on Matlab's search path. The TSexperimentbrowser command in TSlib opens a browser window that enables easy moving around in the Experiment structure, the export of data to Matlab's workspace and much else. The TSsystem Manual.docx file is an extensive, illustrated Manual for the TSsystemÂ© Toolbox. The Guide to the Script.docx file described the contents of each cell of the script.