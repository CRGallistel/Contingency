% TSloadMEDPC   Load a Gallistel lab MEDPC file onto the Experiment structure%   TSloadMEDPC(FILENAME) loads in the data from FILENAME into TSData. This%   code gets rid of the recurring headers and long strings of 0's that%   appear in the raw data files when the data grabber function reads the%   files that appear in the Data folder of MedPC-IV rather than in the%   Backup folderfunction [ SUCCESS , ExperimentID, SubjectID, Phase, Box, MatlabStartDate, Duration, tsdata, Notes, Weight, Program, FileReportedUnits ] = TSloadMEDPC(filename)SUCCESS = 0;%disp('Opening raw:');fid = fopen(filename); % Open fileraw = fscanf(fid,'%f');% Read in whole file as a series of floating point numbersfclose(fid);           % CloseMatlabStartDate = datenum(raw(3)+2000,raw(1),raw(2),raw(11),raw(12),raw(13));Duration = [];SubjectID = raw(7);ExperimentID = raw(8);Phase = raw(9);Box = raw(10);Notes = '';Weight = [];Program = '';FileReportedUnits = [];raw(raw<9999)=[]; %Get rid of anything less than 5 digitstsdata = [floor(raw/(10^5)), raw - ((floor(raw/(10^5)))*(10^5))];% converting data to time in MedPC clock ticks (col 1) and event codes (col% 2)tsdata(tsdata(:,1)==0,:)=[];% sort and remove any duplicates in tsdatatsdata = sortrows(tsdata,1);tsdata1 = circshift(tsdata,1);tslog = (tsdata==tsdata1);tsdata(tslog(:,1) & tslog(:,2),:) = [];% The code above gets rid of the recurring headers and long% strings of 0's that used to appear in the raw data files before we began% reading the backup files, where this crap does not appear%disp('Done.');%disp('Setting last variables:');SUCCESS = 1;