% TSEDIT    Flexibly edit tsdata information.%   TSEDIT(TSDATA,MATCHCODES,EDITCODES) edits TSDATA based on MATCHCODES%   and EDITCODES.  MATCHCODES denotes a cell array of match definitions,%   and EDITCODES denotes a cell array of edit information vectors.  %%   The format of each vector is [MATCHNUM MATCHPOS NEWCODE NEWLOCATIONOFFSET].%   MATCHNUM is the number of the matchcode that matched.  MATCHPOS is the%   position of the code that matched.  NEWCODE is the code to insert into%   the tsdata.  NEWLOCATIONOFFSET sets where the new code goes relative to%   the old code.  If this is set to Inf, the new code will replace the old%   code.  Use a code of 0 and an offset of Inf to delete a code.%% See also TSMATCHfunction edittsdata = TSedit(tsdata,matchcodes,editcodes)TSdeclareeventcodes;result=[];entrynum=0;start=tsdata(1,1);      % Start timestop=tsdata(end,1);     % End timeedittsdata = tsdata;    % Carbon copy of tsdata allows to manipulate array for search without losing original data[matches,bindings]=TSmatch(tsdata,matchcodes);  % Searches for matchesfor lp=1:length(matches);        matchnum=matches(lp);    binding=bindings{lp};        for ed = 1:length(editcodes)    % Allows for use of multiple edit codes        editcode=editcodes{ed};        match=editcode(1);          % Extract information from each edit code        matchpos=editcode(2);        newcode=editcode(3);        newlocoff=editcode(4);                if (match==matchnum)        % If match is found at desired index                        for bindnum = 1:length(binding)  % Goes through each index of binding                if matchpos==bindnum         % If desired index of binding is found,                     pos=binding(bindnum);    % sets pos to value in first column (timestamp)                    % If newlocoff is set to Inf, the desired change                    % replaces the current column.  Otherwise, inserts that                    % information in a new row based on offset value                    if newlocoff==Inf edittsdata(pos,2)=newcode;                    else edittsdata(end+1,:)=[tsdata(pos,1)+newlocoff newcode];                    end;                end;            end;        end;    end;end;edittsdata(edittsdata(:,2)==0,:)=[]; % Remove the zerosedittsdata=sortrows(edittsdata,1);            